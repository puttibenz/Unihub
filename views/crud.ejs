
<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="/css/style_crud.css">
    <link rel="stylesheet" href="/css/user_btn.css">
    <link rel="stylesheet" href="/css/nav.css">
    <link rel="stylesheet" href="/css/footer.css">
</head>
    <body>
        <%- include('partials/nav') %>
            <div class="container">
                <header class="admin-header">
                    <h1>Admin Dashboard</h1>
                    <p class="muted">Manage universities, faculties, departments, and events</p>
                </header>

                <div class="tabs" role="tablist">
                    <div class="tab" data-tab="universities">Universities</div>
                    <div class="tab" data-tab="faculties">Faculties</div>
                    <div class="tab active" data-tab="departments">Departments</div>
                    <div class="tab" data-tab="events">Events</div>
                    <div class="tab" data-tab="announcements">Announcements</div>
                </div>

                <section class="panel" id="panel-universities" style="display:none;">
                    <div class="panel-header">
                        <div>
                            <h3>Universities</h3>
                            <p class="muted">Manage university information</p>
                        </div>
                        <button class="btn-primary" onclick="onAdd('university')">+ Add University</button>
                    </div>
                    <table class="admin-table">
                        <thead>
                            <tr><th>Name</th><th>Location</th><th>Website</th><th>Email</th><th>Contact</th><th>Actions</th></tr>
                        </thead>
                        <tbody>
                            <% const uniSample = (typeof universities !== 'undefined' && universities) ? universities : []; %>
                            <% uniSample.forEach(function(u){ %>
                                <tr>
                                    <td><%= u.name || u.UniversityName || 'Unknown' %></td>
                                    <td><%= u.location || u.Location || '-' %></td>
                                    <td><%= u.website || u.Website || '-' %></td>
                                    <td>A@example.com</td>
                                    <td>1234567890</td>
                                    <td class="actions"><button class="icon-btn" data-id="<%= u.id || '' %>" onclick="onEdit('university', this.dataset.id)">✎</button><button class="icon-btn" data-id="<%= u.id || '' %>" onclick="onDelete('university', this.dataset.id)">🗑</button></td>
                                </tr>
                            <% }) %>
                        </tbody>
                    </table>
                </section>

                <section class="panel" id="panel-faculties" style="display:none;">
                    <div class="panel-header">
                        <div>
                            <h3>Faculties</h3>
                            <p class="muted">Manage faculty information</p>
                        </div>
                        <button class="btn-primary" onclick="onAdd('faculty')">+ Add Faculty</button>
                    </div>
                    <table class="admin-table">
                        <thead>
                            <tr><th>Name</th><th>University</th><th>Email</th><th>Phone</th><th>Actions</th></tr>
                        </thead>
                        <tbody>
                            <% const facSample = (typeof faculties !== 'undefined' && faculties) ? faculties : []; %>
                            <% facSample.forEach(function(f){ %>
                                <tr>
                                    <td><%= f.name || f.FacultyName || 'Unknown' %></td>
                                    <td><%= f.university || f.University || '-' %></td>
                                    <td>A@example.com</td>
                                    <td>1234567890</td>
                                    <td class="actions"><button class="icon-btn" data-id="<%= f.id || '' %>" onclick="onEdit('faculty', this.dataset.id)">✎</button><button class="icon-btn" data-id="<%= f.id || '' %>" onclick="onDelete('faculty', this.dataset.id)">🗑</button></td>
                                </tr>
                            <% }) %>
                        </tbody>
                    </table>
                </section>

                <section class="panel" id="panel-departments">
                    <div class="panel-header">
                        <div>
                            <h3>Departments</h3>
                            <p class="muted">Manage department information</p>
                        </div>
                        <button class="btn-primary" onclick="onAdd('department')">+ Add Department</button>
                    </div>

                    <table class="admin-table">
                        <thead>
                            <tr><th>Name</th><th>Faculty</th><th>University</th><th>Email</th><th>Phone</th><th>Actions</th></tr>
                        </thead>
                        <tbody>
                            <% const depSample = (typeof departments !== 'undefined' && departments) ? departments : []; %>
                            <% depSample.forEach(function(d, idx){ %>
                                <tr>
                                    <td><%= d.name || d.DepartmentName || 'Unknown' %></td>
                                    <td><%= d.faculty || d.Faculty || '-' %></td>
                                    <td><%= d.university || d.University || '-' %></td>
                                    <td>A@example.com</td>
                                    <td>1234567890</td>
                                    <td class="actions">
                                        <button class="icon-btn" data-id="<%= d.id != null ? d.id : idx %>" onclick="onEdit('department', this.dataset.id)">✎</button>
                                        <button class="icon-btn" data-id="<%= d.id != null ? d.id : idx %>" onclick="onDelete('department', this.dataset.id)">🗑</button>
                                    </td>
                                </tr>
                            <% }) %>
                        </tbody>
                    </table>
                </section>

                <section class="panel" id="panel-events" style="display:none;">
                    <div class="panel-header">
                        <div>
                            <h3>Events</h3>
                            <p class="muted">Manage events</p>
                        </div>
                        <div class="panel-controls">
                            <button class="btn-primary" onclick="onAdd('event')">+ Add Event</button>
                        </div>
                    </div>
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>Title</th>
                                <th>Description</th>
                                <th>Location</th>
                                <th>Start Time</th>
                                <th>End Time</th>
                                <th>Category</th>
                                <th>University</th>
                                <th>Faculty</th>
                                <th>Department</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% const evSample = (typeof events !== 'undefined' && events) ? events : []; %>
                            <% evSample.forEach(function(e){ %>
                                <tr data-category="<%= (e.category || '') %>">
                                    <td><%= e.title || e.Title || 'Untitled' %></td>
                                    <td><%= e.description || '-' %></td>
                                    <td><%= e.location || '-' %></td>
                                    <td><%= e.start_time || e.startTime || '-' %></td>
                                    <td><%= e.end_time || e.endTime || '-' %></td>
                                    <td><%= e.category || '-' %></td>
                                    <td><%= e.university || '-' %></td>
                                    <td><%= e.faculty || '-' %></td>
                                    <td><%= e.department || '-' %></td>
                                    <td class="actions"><button class="icon-btn" data-id="<%= e.id || '' %>" onclick="onEdit('event', this.dataset.id)">✎</button><button class="icon-btn" data-id="<%= e.id || '' %>" onclick="onDelete('event', this.dataset.id)">🗑</button></td>
                                </tr>
                            <% }) %>
                        </tbody>
                    </table>
                </section>
                
                <section class="panel" id="panel-announcements" style="display:none;">
                    <div class="panel-header">
                        <div>
                            <h3>Announcements</h3>
                            <p class="muted">Manage campus announcements</p>
                        </div>
                        <div class="panel-controls">
                            <button class="btn-primary" onclick="onAdd('announcement')">+ Add Announcement</button>
                        </div>
                    </div>
                    <table class="admin-table">
                        <thead>
                            <tr><th>Title</th><th>Description</th><th>University</th><th>Faculty</th><th>Department</th><th>Actions</th></tr>
                        </thead>
                        <tbody>
                            <% const annSample = (typeof announcements !== 'undefined' && announcements) ? announcements : []; %>
                            <% annSample.forEach(function(a){ %>
                                <tr>
                                    <td><%= a.title || a.Title || 'Untitled' %></td>
                                    <td><%= a.description || '-' %></td>
                                    <td><%= a.university || a.University || '-' %></td>
                                    <td><%= a.faculty || '-' %></td>
                                    <td><%= a.department || '-' %></td>
                                    <td class="actions"><button class="icon-btn" data-id="<%= a.id || '' %>" onclick="onEdit('announcement', this.dataset.id)">✎</button><button class="icon-btn" data-id="<%= a.id || '' %>" onclick="onDelete('announcement', this.dataset.id)">🗑</button></td>
                                </tr>
                            <% }) %>
                        </tbody>
                    </table>
                </section>
                
                

            </div>

                <!-- Modal UI (client-only) -->
                <div id="add-modal" class="hidden" aria-hidden="true">
                    <div class="modal-backdrop" aria-hidden="true"></div>
                    <div class="modal-wrapper" role="dialog" aria-modal="true">
                        <div class="modal-box">
                            <h3 id="add-modal-title">Add</h3>
                            <form id="add-modal-form">
                                <!-- University -->
                                <div id="form-university" class="hidden">
                                    <label class="form-label">ชื่อมหาวิทยาลัย</label>
                                    <input id="uni-name" type="text" placeholder="ชื่อมหาวิทยาลัย" class="form-control" />
                                    <label class="form-label">ที่ตั้ง</label>
                                    <input id="uni-location" type="text" placeholder="เช่น กรุงเทพมหานคร" class="form-control" />
                                    <label class="form-label">เว็บไซต์</label>
                                    <input id="uni-website" type="url" placeholder="https://example.ac.th" class="form-control" />
                                    <label class="form-label">อีเมลติดต่อ</label>
                                    <input id="uni-email" type="email" placeholder="contact@example.ac.th" class="form-control" />
                                    <label class="form-label">เบอร์ติดต่อ</label>
                                    <input id="uni-contact" type="tel" placeholder="0xx-xxx-xxxx" class="form-control" />
                                </div>

                                <!-- Faculty -->
                                <div id="form-faculty" class="hidden">
                                    <label class="form-label">มหาวิทยาลัย</label>
                                    <select id="fac-university" class="form-control"></select>
                                    <label class="form-label">ชื่อคณะ</label>
                                    <input id="fac-name" type="text" placeholder="ชื่อคณะ" class="form-control" />
                                    <label class="form-label">อีเมลติดต่อ</label>
                                    <input id="fac-email" type="email" placeholder="contact@faculty.ac.th" class="form-control" />
                                    <label class="form-label">เบอร์โทรศัพท์</label>
                                    <input id="fac-phone" type="tel" placeholder="0xx-xxx-xxxx" class="form-control" />
                                </div>

                                <!-- Department -->
                                <div id="form-department" class="hidden">
                                    <label class="form-label">มหาวิทยาลัย</label>
                                    <select id="dept-university" class="form-control"></select>
                                    <label class="form-label">คณะ</label>
                                    <select id="dept-faculty" class="form-control"></select>
                                    <label class="form-label">ชื่อสาขา</label>
                                    <input id="dept-name" type="text" placeholder="ชื่อสาขา" class="form-control" />
                                    <label class="form-label">อีเมลติดต่อ</label>
                                    <input id="dept-email" type="email" placeholder="contact@dept.ac.th" class="form-control" />
                                    <label class="form-label">เบอร์โทรศัพท์</label>
                                    <input id="dept-phone" type="tel" placeholder="0xx-xxx-xxxx" class="form-control" />
                                </div>

                                <!-- Event -->
                                <div id="form-event" class="hidden">
                                    <label class="form-label">มหาวิทยาลัย</label>
                                    <select id="event-university" class="form-control"></select>
                                    <label class="form-label">คณะ</label>
                                    <select id="event-faculty" class="form-control"></select>
                                    <label class="form-label">สาขา</label>
                                    <select id="event-major" class="form-control"></select>
                                    <label class="form-label">ประเภท (Category)</label>
                                    <select id="event-category" class="form-control"></select>
                                    <label class="form-label">Title</label>
                                    <input id="event-title" type="text" placeholder="ชื่อกิจกรรม" class="form-control" />
                                    <label class="form-label">Description</label>
                                    <textarea id="event-description" rows="3" class="form-control"></textarea>
                                    <label class="form-label">Location</label>
                                    <input id="event-location" type="text" class="form-control" />
                                    <label class="form-label">Start Time</label>
                                    <input id="event-start" type="datetime-local" class="form-control" />
                                    <label class="form-label">End Time</label>
                                    <input id="event-end" type="datetime-local" class="form-control" />
                                </div>

                                <!-- Announcement -->
                                <div id="form-announcement" class="hidden">
                                    <label class="form-label">Title</label>
                                    <input id="ann-title" type="text" class="form-control" />
                                    <label class="form-label">Description</label>
                                    <textarea id="ann-description" rows="3" class="form-control"></textarea>
                                    <label class="form-label">มหาวิทยาลัย</label>
                                    <select id="ann-university" class="form-control"></select>
                                    <label class="form-label">คณะ (optional)</label>
                                    <input id="ann-faculty" type="text" class="form-control" placeholder="ชื่อคณะ (ถ้ามี)" />
                                    <label class="form-label">สาขา (optional)</label>
                                    <input id="ann-department" type="text" class="form-control" placeholder="ชื่อสาขา (ถ้ามี)" />
                                </div>

                                <div class="modal-actions">
                                    <button type="button" id="add-modal-cancel" class="btn-primary btn-cancel">ยกเลิก</button>
                                    <button type="submit" class="btn-primary btn-submit">บันทึก</button>
                                </div>
                            </form>
                    </div>
                </div>
            </div>

            <!-- <%- include('partials/footer') %> -->

            <!-- data container (JSON embedded safely in HTML attributes) -->
            <div id="__DATA__container" class="hidden"
                data-universities='<%- JSON.stringify(typeof universities !== "undefined" ? universities : []) %>'
                data-faculties='<%- JSON.stringify(typeof faculties !== "undefined" ? faculties : []) %>'
                data-departments='<%- JSON.stringify(typeof departments !== "undefined" ? departments : []) %>'
                data-categories='<%- JSON.stringify(typeof categories !== "undefined" ? categories : []) %>'></div>

        <script src="public/js/crud.js"></script>
    </body>
</html>


